---
import { getEntry } from "astro:content"
import Layout from "../../layouts/Layout.astro"
import '../../styles/post.css'
import TitleGroup from "../ui/TitleGroup.astro"
import Link from "../Link.astro"

const post = await getEntry('blog', Astro.params.post as string)

const dateFormat = new Intl.DateTimeFormat(Astro.currentLocale, {dateStyle: "full"})

const publicationDateFormated = dateFormat.format(post?.data.publishedDate)
---

<Layout
showLanguageMenu={false}
title={post?.data.title || 'No title'}
pubDatetime={post?.data.publishedDate}
modDatetime={post?.data.updatedDate}
>
	<article>
		<TitleGroup title={post?.data.title} subtitle={publicationDateFormated} />
		{<ul class="p-4 bg-slate-50 rounded mb-4">
			{post?.render().then((result) => result.headings.map((heading) => <li><Link href={`#${heading.slug}`}>
				{heading.text}
			</Lin></li>))}
		</ul>}
		<Fragment set:html={post?.rendered?.html}/>
	</article>
</Layout>